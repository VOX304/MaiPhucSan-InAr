{"ast":null,"code":"import { BehaviorSubject, tap, map } from 'rxjs';\nimport { environment } from '../../environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nconst STORAGE_TOKEN_KEY = 'inar_auth_token';\nconst STORAGE_USER_KEY = 'inar_auth_user';\nexport let AuthService = /*#__PURE__*/(() => {\n  class AuthService {\n    constructor(http) {\n      this.http = http;\n      this.userSubject = new BehaviorSubject(this.loadUser());\n    }\n    /**\n     * Current user as observable.\n     */\n    user$() {\n      return this.userSubject.asObservable();\n    }\n    /**\n     * Current user snapshot.\n     */\n    get user() {\n      return this.userSubject.value;\n    }\n    get token() {\n      return localStorage.getItem(STORAGE_TOKEN_KEY);\n    }\n    get isAuthenticated() {\n      return !!this.token;\n    }\n    login(username, password) {\n      return this.http.post(`${environment.apiBaseUrl}/auth/login`, {\n        username,\n        password\n      }).pipe(tap(res => {\n        localStorage.setItem(STORAGE_TOKEN_KEY, res.data.token);\n        localStorage.setItem(STORAGE_USER_KEY, JSON.stringify(res.data.user));\n        this.userSubject.next(res.data.user);\n      }), map(res => res.data.user));\n    }\n    logout() {\n      localStorage.removeItem(STORAGE_TOKEN_KEY);\n      localStorage.removeItem(STORAGE_USER_KEY);\n      this.userSubject.next(null);\n    }\n    loadUser() {\n      try {\n        const raw = localStorage.getItem(STORAGE_USER_KEY);\n        return raw ? JSON.parse(raw) : null;\n      } catch {\n        return null;\n      }\n    }\n    static {\n      this.ɵfac = function AuthService_Factory(t) {\n        return new (t || AuthService)(i0.ɵɵinject(i1.HttpClient));\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: AuthService,\n        factory: AuthService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return AuthService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}