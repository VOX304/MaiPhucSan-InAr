{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/api.service\";\nimport * as i2 from \"../../services/auth.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"@angular/material/button\";\nimport * as i6 from \"@angular/material/card\";\nimport * as i7 from \"@angular/material/form-field\";\nimport * as i8 from \"@angular/material/input\";\nconst _c0 = () => [];\nfunction SalesmanPerformanceComponent_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 14);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.error, \" \");\n  }\n}\nfunction SalesmanPerformanceComponent_div_32_li_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementStart(2, \"strong\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const r_r4 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", r_r4.createdAt, \" \\u2014 \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(r_r4.byUsername);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\" (\", r_r4.role, \"): \", r_r4.text, \" \");\n  }\n}\nfunction SalesmanPerformanceComponent_div_32_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"p\")(2, \"strong\");\n    i0.ɵɵtext(3, \"Status:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4);\n    i0.ɵɵelementStart(5, \"strong\");\n    i0.ɵɵtext(6, \"Total:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(7);\n    i0.ɵɵpipe(8, \"number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"button\", 15);\n    i0.ɵɵlistener(\"click\", function SalesmanPerformanceComponent_div_32_Template_button_click_9_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.confirmBonus());\n    });\n    i0.ɵɵtext(10, \" Confirm bonus (N_FR4) \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"h5\", 16);\n    i0.ɵɵtext(12, \"Remarks\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"ul\");\n    i0.ɵɵtemplate(14, SalesmanPerformanceComponent_div_32_li_14_Template, 5, 4, \"li\", 13);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.bonus.status, \" \\u2014 \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(8, 4, ctx_r1.bonus.totalBonusEur, \"1.2-2\"), \" EUR \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", ctx_r1.bonus.status !== \"RELEASED_TO_SALESMAN\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.bonus.remarks || i0.ɵɵpureFunction0(7, _c0));\n  }\n}\nfunction SalesmanPerformanceComponent_ng_template_33_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1, \"No bonus released yet.\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SalesmanPerformanceComponent_tr_57_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 17);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\", 17);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\", 17);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\", 17);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\", 17);\n    i0.ɵɵtext(10);\n    i0.ɵɵpipe(11, \"number\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const r_r5 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(r_r5.criterionName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(r_r5.targetValue);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(r_r5.actualValue);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(r_r5.weight);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(11, 5, r_r5.computedBonusEur, \"1.2-2\"));\n  }\n}\nfunction SalesmanPerformanceComponent_tr_78_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 17);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\", 17);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\", 17);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\", 17);\n    i0.ɵɵtext(8);\n    i0.ɵɵpipe(9, \"number\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const o_r6 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(o_r6.orderId);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(o_r6.productName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(o_r6.clientName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(9, 4, o_r6.computedBonusEur, \"1.2-2\"));\n  }\n}\nfunction SalesmanPerformanceComponent_ul_82_li_1_span_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \" (stored in OrangeHRM)\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SalesmanPerformanceComponent_ul_82_li_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementStart(2, \"strong\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4);\n    i0.ɵɵtemplate(5, SalesmanPerformanceComponent_ul_82_li_1_span_5_Template, 2, 0, \"span\", 18);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const q_r7 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", q_r7.year, \" \\u2014 \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(q_r7.title);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\": \", q_r7.description, \" \");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", q_r7.storedInOrangeHrmAt);\n  }\n}\nfunction SalesmanPerformanceComponent_ul_82_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ul\");\n    i0.ɵɵtemplate(1, SalesmanPerformanceComponent_ul_82_li_1_Template, 6, 4, \"li\", 13);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.qualifications);\n  }\n}\nfunction SalesmanPerformanceComponent_ng_template_83_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1, \"No qualifications yet.\");\n    i0.ɵɵelementEnd();\n  }\n}\nexport let SalesmanPerformanceComponent = /*#__PURE__*/(() => {\n  class SalesmanPerformanceComponent {\n    constructor(api, auth) {\n      this.api = api;\n      this.auth = auth;\n      this.employeeId = '';\n      this.year = new Date().getFullYear();\n      this.socialRecords = [];\n      this.socialTotalEur = 0;\n      this.orders = [];\n      this.ordersTotalEur = 0;\n      this.bonus = null;\n      this.qualifications = [];\n      this.error = null;\n    }\n    ngOnInit() {\n      this.employeeId = this.auth.user?.employeeId || 'E1001';\n      this.reloadAll();\n    }\n    reloadAll() {\n      this.loadSocial();\n      this.loadOrders();\n      this.loadBonus();\n      this.loadQualifications();\n    }\n    loadSocial() {\n      this.api.listSocial(this.employeeId, this.year).subscribe({\n        next: res => {\n          this.socialRecords = res.data.records;\n          this.socialTotalEur = res.data.socialTotalEur;\n        },\n        error: err => this.error = err?.error?.error || 'Load social records failed'\n      });\n    }\n    loadOrders() {\n      this.api.listOrders(this.employeeId, this.year, false).subscribe({\n        next: res => {\n          this.orders = res.data.records;\n          this.ordersTotalEur = res.data.ordersTotalEur;\n        },\n        error: () => {\n          // Orders are optional; ignore errors if not implemented / not configured\n        }\n      });\n    }\n    loadBonus() {\n      this.api.getBonus(this.employeeId, this.year).subscribe({\n        next: res => this.bonus = res.data,\n        error: () => this.bonus = null\n      });\n    }\n    loadQualifications() {\n      this.api.listQualifications(this.employeeId, this.year).subscribe({\n        next: res => this.qualifications = res.data,\n        error: () => this.qualifications = []\n      });\n    }\n    confirmBonus() {\n      this.error = null;\n      this.api.confirmBonus(this.employeeId, this.year).subscribe({\n        next: res => this.bonus = res.data,\n        error: err => this.error = err?.error?.error || 'Confirm failed'\n      });\n    }\n    static {\n      this.ɵfac = function SalesmanPerformanceComponent_Factory(t) {\n        return new (t || SalesmanPerformanceComponent)(i0.ɵɵdirectiveInject(i1.ApiService), i0.ɵɵdirectiveInject(i2.AuthService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: SalesmanPerformanceComponent,\n        selectors: [[\"app-salesman-performance\"]],\n        decls: 85,\n        vars: 17,\n        consts: [[\"noBonus\", \"\"], [\"noQual\", \"\"], [2, \"margin-bottom\", \"16px\"], [\"style\", \"margin: 10px 0; color: #b00020\", 4, \"ngIf\"], [2, \"display\", \"flex\", \"gap\", \"12px\", \"flex-wrap\", \"wrap\", \"align-items\", \"center\"], [\"appearance\", \"fill\"], [\"matInput\", \"\", 3, \"ngModelChange\", \"ngModel\"], [\"appearance\", \"fill\", 2, \"width\", \"140px\"], [\"matInput\", \"\", \"type\", \"number\", 3, \"ngModelChange\", \"ngModel\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", 3, \"click\"], [4, \"ngIf\", \"ngIfElse\"], [1, \"mat-elevation-z1\", 2, \"width\", \"100%\", \"border-collapse\", \"collapse\"], [2, \"text-align\", \"left\", \"padding\", \"6px\"], [4, \"ngFor\", \"ngForOf\"], [2, \"margin\", \"10px 0\", \"color\", \"#b00020\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", 3, \"click\", \"disabled\"], [2, \"margin-top\", \"16px\"], [2, \"padding\", \"6px\"], [4, \"ngIf\"]],\n        template: function SalesmanPerformanceComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            const _r1 = i0.ɵɵgetCurrentView();\n            i0.ɵɵelementStart(0, \"mat-card\", 2)(1, \"h3\");\n            i0.ɵɵtext(2, \"Salesman View\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(3, \"p\");\n            i0.ɵɵtext(4, \" This view supports: \");\n            i0.ɵɵelementStart(5, \"strong\");\n            i0.ɵɵtext(6, \"C_FR6\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(7, \" (salesman sees computation), \");\n            i0.ɵɵelementStart(8, \"strong\");\n            i0.ɵɵtext(9, \"C_FR9\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(10, \" (sees qualifications), and \");\n            i0.ɵɵelementStart(11, \"strong\");\n            i0.ɵɵtext(12, \"N_FR4\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(13, \" (confirm bonus). \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(14, SalesmanPerformanceComponent_div_14_Template, 2, 1, \"div\", 3);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(15, \"mat-card\", 2)(16, \"h4\");\n            i0.ɵɵtext(17, \"Selection\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(18, \"div\", 4)(19, \"mat-form-field\", 5)(20, \"mat-label\");\n            i0.ɵɵtext(21, \"EmployeeId\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(22, \"input\", 6);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function SalesmanPerformanceComponent_Template_input_ngModelChange_22_listener($event) {\n              i0.ɵɵrestoreView(_r1);\n              i0.ɵɵtwoWayBindingSet(ctx.employeeId, $event) || (ctx.employeeId = $event);\n              return i0.ɵɵresetView($event);\n            });\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(23, \"mat-form-field\", 7)(24, \"mat-label\");\n            i0.ɵɵtext(25, \"Year\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(26, \"input\", 8);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function SalesmanPerformanceComponent_Template_input_ngModelChange_26_listener($event) {\n              i0.ɵɵrestoreView(_r1);\n              i0.ɵɵtwoWayBindingSet(ctx.year, $event) || (ctx.year = $event);\n              return i0.ɵɵresetView($event);\n            });\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(27, \"button\", 9);\n            i0.ɵɵlistener(\"click\", function SalesmanPerformanceComponent_Template_button_click_27_listener() {\n              i0.ɵɵrestoreView(_r1);\n              return i0.ɵɵresetView(ctx.reloadAll());\n            });\n            i0.ɵɵtext(28, \"Reload\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(29, \"mat-card\", 2)(30, \"h4\");\n            i0.ɵɵtext(31, \"Bonus\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(32, SalesmanPerformanceComponent_div_32_Template, 15, 8, \"div\", 10)(33, SalesmanPerformanceComponent_ng_template_33_Template, 2, 0, \"ng-template\", null, 0, i0.ɵɵtemplateRefExtractor);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(35, \"mat-card\", 2)(36, \"h4\");\n            i0.ɵɵtext(37, \"Social performance\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(38, \"p\")(39, \"strong\");\n            i0.ɵɵtext(40, \"Social total:\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(41);\n            i0.ɵɵpipe(42, \"number\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(43, \"table\", 11)(44, \"thead\")(45, \"tr\")(46, \"th\", 12);\n            i0.ɵɵtext(47, \"Criterion\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(48, \"th\", 12);\n            i0.ɵɵtext(49, \"Target\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(50, \"th\", 12);\n            i0.ɵɵtext(51, \"Actual\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(52, \"th\", 12);\n            i0.ɵɵtext(53, \"Weight\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(54, \"th\", 12);\n            i0.ɵɵtext(55, \"Bonus\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(56, \"tbody\");\n            i0.ɵɵtemplate(57, SalesmanPerformanceComponent_tr_57_Template, 12, 8, \"tr\", 13);\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(58, \"mat-card\", 2)(59, \"h4\");\n            i0.ɵɵtext(60, \"Orders evaluation\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(61, \"p\")(62, \"strong\");\n            i0.ɵɵtext(63, \"Orders total:\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(64);\n            i0.ɵɵpipe(65, \"number\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(66, \"table\", 11)(67, \"thead\")(68, \"tr\")(69, \"th\", 12);\n            i0.ɵɵtext(70, \"OrderId\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(71, \"th\", 12);\n            i0.ɵɵtext(72, \"Product\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(73, \"th\", 12);\n            i0.ɵɵtext(74, \"Client\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(75, \"th\", 12);\n            i0.ɵɵtext(76, \"Bonus\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(77, \"tbody\");\n            i0.ɵɵtemplate(78, SalesmanPerformanceComponent_tr_78_Template, 10, 7, \"tr\", 13);\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(79, \"mat-card\")(80, \"h4\");\n            i0.ɵɵtext(81, \"Qualifications\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(82, SalesmanPerformanceComponent_ul_82_Template, 2, 1, \"ul\", 10)(83, SalesmanPerformanceComponent_ng_template_83_Template, 2, 0, \"ng-template\", null, 1, i0.ɵɵtemplateRefExtractor);\n            i0.ɵɵelementEnd();\n          }\n          if (rf & 2) {\n            const noBonus_r8 = i0.ɵɵreference(34);\n            const noQual_r9 = i0.ɵɵreference(84);\n            i0.ɵɵadvance(14);\n            i0.ɵɵproperty(\"ngIf\", ctx.error);\n            i0.ɵɵadvance(8);\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.employeeId);\n            i0.ɵɵadvance(4);\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.year);\n            i0.ɵɵadvance(6);\n            i0.ɵɵproperty(\"ngIf\", ctx.bonus)(\"ngIfElse\", noBonus_r8);\n            i0.ɵɵadvance(9);\n            i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(42, 11, ctx.socialTotalEur, \"1.2-2\"), \" EUR\");\n            i0.ɵɵadvance(16);\n            i0.ɵɵproperty(\"ngForOf\", ctx.socialRecords);\n            i0.ɵɵadvance(7);\n            i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(65, 14, ctx.ordersTotalEur, \"1.2-2\"), \" EUR\");\n            i0.ɵɵadvance(14);\n            i0.ɵɵproperty(\"ngForOf\", ctx.orders);\n            i0.ɵɵadvance(4);\n            i0.ɵɵproperty(\"ngIf\", ctx.qualifications.length)(\"ngIfElse\", noQual_r9);\n          }\n        },\n        dependencies: [i3.NgForOf, i3.NgIf, i4.DefaultValueAccessor, i4.NumberValueAccessor, i4.NgControlStatus, i4.NgModel, i5.MatButton, i6.MatCard, i7.MatFormField, i7.MatLabel, i8.MatInput, i3.DecimalPipe],\n        encapsulation: 2\n      });\n    }\n  }\n  return SalesmanPerformanceComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}